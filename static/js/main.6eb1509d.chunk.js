(this.webpackJsonptwitchsubathon=this.webpackJsonptwitchsubathon||[]).push([[0],{13:function(e,n,t){"use strict";(function(e){var c=t(5),a=t(2),r=t(0),i=t(20),s=t(1);n.a=function(){var n=Object(r.useState)("Loading..."),t=Object(a.a)(n,2),o=t[0],d=t[1],l=Object(r.useState)({goals:{},twitchUsername:"",initialMinutes:0,secondsPerSub:0,secondsPerBit:0,secondsPerPenny:0}),u=Object(a.a)(l,2),b=u[0],j=u[1];Object(r.useEffect)((function(){var n=new URLSearchParams(window.location.search).get("config"),t=e.from(n,"base64"),c=JSON.parse(t);j(c)}),[]);var f=Object(r.useState)(0),h=Object(a.a)(f,2),O=h[0],p=h[1],w=Object(r.useState)(0),m=Object(a.a)(w,2),g=m[0],v=m[1],x=Object(r.useState)(new Date(Date.now()+60*b.initialMinutes*1e3)),S=Object(a.a)(x,2),D=S[0],k=S[1],I=Object(r.useState)(new Date(0)),y=Object(a.a)(I,2),E=y[0],N=y[1],C=function(e){e>0&&N(Date.now()),k(new Date(D.getTime()+1e3*e)),v(g+e)};Object(r.useEffect)((function(){k(new Date(Date.now()+60*b.initialMinutes*1e3+1e3*g))}),[b]);var M=Object(r.useRef)(null);Object(r.useEffect)((function(){return M.current=new WebSocket("wss://irc-ws.chat.twitch.tv/"),M.current.onopen=function(){d("Connecting..."),M.current.send("NICK "+P()),d("Joining Twitch chat..."),M.current.send("JOIN #"+b.twitchUsername),d("")},M.current.onerror=function(){d("\ud83d\uded1 Connection to Twitch Chat Error \ud83d\uded1")},M.current.onclose=function(){d("\ud83d\uded1 Connection to Twitch Closed \ud83d\uded1")},function(){M.current.close()}}),[b]),Object(r.useEffect)((function(){M.current&&(M.current.onmessage=function(e){var n=e.data;if(n.startsWith("PING :tmi.twitch.tv"))return console.log("Received a PING, sending back PONG"),void M.current.send("PONG :tmi.twitch.tv");if(n.includes("PRIVMSG")){var t=n.split("#")[1],a=t.substring(t.indexOf(":")+1).split("\r\n")[0];switch(n.split("@")[1].split(".tmi.twitch.tv")[0]){case"jimib95":case b.twitchUsername:var r=a.match(/!subathonreset/i),i=a.match(/!addsubs (-?\d+)/i),s=a.match(/!addminutes (-?\d+)/i);r&&j(Object(c.a)({},b)),i&&(o=parseInt(i[1]),p(O+o),C(o*b.secondsPerSub)),s&&C(parseInt(60*s[1]))}}else{var o;if(n.includes("Welcome")||n.includes("JOIN")||n.includes("NAMES"))console.log("Received a known, ignored, message",n);else console.error("Unhandled message",n)}})}));var P=function(){return"justinfan"+(Math.floor(9e4*Math.random())+9999)};return Object(s.jsx)(s.Fragment,{children:o.length>0&&void 0!==b?Object(s.jsx)("span",{children:o}):Object(s.jsx)(i.a,{config:b,subsThisStream:O,subathonEndDate:D,timeLastAdded:E})})}}).call(this,t(27).Buffer)},20:function(e,n,t){"use strict";var c=t(3),a=t(4),r=t(19),i=t(2),s=t(0),o=t(14),d=t.n(o),l=t(15),u=t(1);var b,j,f,h,O=function(e){var n=e.children,t=Object(s.useState)(!1),c=Object(i.a)(t,2),a=c[0],r=c[1],o=Object(s.useRef)(null);return Object(s.useEffect)((function(){var e=Object(l.a)(n,"normal 800 25px sans-serif");r(e>o.current.offsetWidth)}),[n]),Object(u.jsx)("div",{ref:o,children:a?Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)(d.a,{gradient:!1,speed:40,children:[n,"\xa0-\xa0"]})}):Object(u.jsx)(u.Fragment,{children:n})})};var p,w,m,g,v,x,S,D=function(e){var n=Math.abs(parseInt(e/60/60)).toString().padStart(2,"0"),t=Math.abs(parseInt(e/60%60)).toString().padStart(2,"0"),c=Math.abs(parseInt(e%60)).toString().padStart(2,"0");return"".concat(e<0?"-":"").concat(n,":").concat(t,":").concat(c)},k=a.a.span(b||(b=Object(c.a)(["\n  \n  animation: blinkRecentlyAdded step-end 0.3s infinite;\n\n  @keyframes blinkRecentlyAdded{\n    0% {\n      color: transparent;\n    }\n    50% {\n      color: #2ECC40;\n    }\n    100% {\n      color: transparent;\n    }\n  }\n"]))),I=a.a.span(j||(j=Object(c.a)(["\n  color: #FF4136;\n"]))),y=a.a.span(f||(f=Object(c.a)(["\n  \n  animation: blinkCritical step-end 0.6s infinite;\n\n  @keyframes blinkCritical{\n    0% {\n      color: transparent;\n    }\n    30% {\n      color: #FF4136;\n    }\n    70% {\n      color: #FF4136;\n    }\n    100% {\n      color: transparent;\n    }\n  }\n"]))),E=a.a.span(h||(h=Object(c.a)(["\n  color: black;\n"]))),N=function(e){var n=e.endDate,t=e.timeLastAdded,c=Object(s.useState)(!1),a=Object(i.a)(c,2),r=a[0],o=a[1],d=Object(s.useState)(""),l=Object(i.a)(d,2),b=l[0],j=l[1],f=Object(s.useState)(!1),h=Object(i.a)(f,2),O=h[0],p=h[1],w=Object(s.useState)(!1),m=Object(i.a)(w,2),g=m[0],v=m[1];return Object(s.useEffect)((function(){var e=setInterval((function(){o(new Date-t<=3e3),p(n-new Date<=36e5),v(n-new Date<=3e5),j(D(new Date(n-new Date)/1e3))}),200);return function(){return clearInterval(e)}}),[n,t]),r?Object(u.jsx)(k,{children:b}):g?Object(u.jsx)(y,{children:b}):O?Object(u.jsx)(I,{children:b}):Object(u.jsx)(E,{children:b})};var C=a.a.div(p||(p=Object(c.a)(["\n  font-weight: bold;\n  text-transform: uppercase;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  text-align: left;\n  width: 100%;\n"]))),M=a.a.div(w||(w=Object(c.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 65%;\n  align-items: flex-start;\n"]))),P=a.a.div(m||(m=Object(c.a)(["\n  font-size: 3rem;\n  width: 35%;\n"]))),A=a.a.div(g||(g=Object(c.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n"]))),F=a.a.div(v||(v=Object(c.a)(["\n  .progress-bar{\n    background-color: #001f3f;\n  }\n"]))),R=a.a.div(x||(x=Object(c.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n"]))),J=a.a.div(S||(S=Object(c.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  padding: 0.5rem;\n  font-size: 1.5rem;\n  color: white;\n  background: linear-gradient(77deg, rgb(28,33,43) 0%, rgb(28,44,52) 50%, rgb(28,36,52) 100%);\n  width: 600px;\n  height: 150px;\n"])));n.a=function(e){var n=e.config,t=e.subsThisStream,c=e.subathonEndDate,a=e.timeLastAdded,i=function(){var e=Object.entries(n.goals).sort((function(e){return e[0]})).filter((function(e){return e[0]<=t}));return e.length>0?e[e.length-1]:[0,"No goal achieved"]},s=function(){var e=[1/0,"All goals achieved"],c=Object.entries(n.goals).sort((function(e){return e[0]})).filter((function(e){return e[0]>t}));return c.length>0?c[0]:e};return Object(u.jsx)("div",{className:"App",children:Object(u.jsxs)(J,{className:"SubathonContainer",children:[Object(u.jsxs)(A,{children:[Object(u.jsxs)(M,{children:[Object(u.jsxs)("span",{children:[s()[0]-t," subs needed for:"]}),Object(u.jsx)(C,{children:Object(u.jsx)(O,{children:s()[1]})})]}),Object(u.jsx)(P,{children:Object(u.jsx)(N,{endDate:c,timeLastAdded:a})})]}),Object(u.jsxs)(F,{children:[Object(u.jsx)(r.a,{animated:!0,now:t,min:i()[0],max:s()[0]}),Object(u.jsxs)(R,{children:[Object(u.jsx)("span",{children:i()[0]}),Object(u.jsx)("span",{children:t}),Object(u.jsx)("span",{children:s()[0]})]})]})]})})}},21:function(e,n,t){"use strict";t.r(n);var c=t(0),a=t.n(c),r=t(12),i=t.n(r),s=(t(26),t(13)),o=t(1);i.a.render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(s.a,{})}),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.6eb1509d.chunk.js.map