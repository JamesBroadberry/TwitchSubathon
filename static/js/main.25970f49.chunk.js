(this.webpackJsonptwitchsubathon=this.webpackJsonptwitchsubathon||[]).push([[0],{13:function(e,t,n){"use strict";(function(e){var a=n(5),r=n(2),c=n(0),s=n(20),i=n(1);t.a=function(){var t=Object(c.useState)("Loading..."),n=Object(r.a)(t,2),o=n[0],d=n[1],b=Object(c.useState)({goals:{},twitchUsername:"",initialMinutes:0,secondsPerPrimeSub:0,secondsPerTier1Sub:0,secondsPerTier2Sub:0,secondsPerTier3Sub:0,secondsPerBit:0,secondsPerPenny:0}),u=Object(r.a)(b,2),l=u[0],j=u[1];Object(c.useEffect)((function(){var t=new URLSearchParams(window.location.search).get("config"),n=e.from(t,"base64"),a=JSON.parse(n);j(a)}),[]);var h=Object(c.useState)(0),f=Object(r.a)(h,2),O=f[0],m=f[1],p=Object(c.useState)(0),v=Object(r.a)(p,2),w=v[0],g=v[1],x=Object(c.useState)(new Date(Date.now()+60*l.initialMinutes*1e3)),S=Object(r.a)(x,2),P=S[0],T=S[1],k=Object(c.useState)(new Date(0)),D=Object(r.a)(k,2),I=D[0],y=D[1],E=function(e){m(O+e)},N=function(e){e>0&&y(Date.now()),T(new Date(P.getTime()+1e3*e)),g(w+e)};Object(c.useEffect)((function(){T(new Date(Date.now()+60*l.initialMinutes*1e3+1e3*w))}),[l]);var C=Object(c.useRef)(null);Object(c.useEffect)((function(){return C.current=new WebSocket("wss://irc-ws.chat.twitch.tv/"),C.current.onopen=function(){d("Connecting..."),C.current.send("NICK "+M()),d("Joining Twitch chat..."),C.current.send("JOIN #"+l.twitchUsername),d("")},C.current.onerror=function(){d("\ud83d\uded1 Connection to Twitch Chat Error \ud83d\uded1")},C.current.onclose=function(){d("\ud83d\uded1 Connection to Twitch Closed \ud83d\uded1")},function(){C.current.close()}}),[l]),Object(c.useEffect)((function(){C.current&&(C.current.onmessage=function(e){var t=e.data;if(t.startsWith("PING :tmi.twitch.tv"))return console.log("Received a PING, sending back PONG"),void C.current.send("PONG :tmi.twitch.tv");if(t.includes("PRIVMSG")){var n=t.split("#")[1],r=n.substring(n.indexOf(":")+1).split("\r\n")[0];switch(t.split("@")[1].split(".tmi.twitch.tv")[0]){case"jimib95":case l.twitchUsername:var c=r.match(/!subathonreset/i),s=r.match(/!addsubs (-?\d+)/i),i=r.match(/!addminutes (-?\d+)/i);if(c&&j(Object(a.a)({},l)),s){var o=parseInt(s[1]);E(o),N(o*l.secondsPerPrimeSub)}i&&N(parseInt(60*i[1]));break;case"streamlabs":var d=r.match(/has cheered (\d+) bits/i),b=r.match(/just tipped \$(.*)!/i),u=r.match(/just subscribed with (.*)!/i),h=r.match(/just gifted (\d+) (.*) subscriptions!/i);if(d){var f=parseInt(d[1]);N(f*l.secondsPerBit)}if(b){var O=100*parseFloat(b[1]);N(O*l.secondsPerPenny)}if(u)switch(E(1),u[1]){case"Twitch Prime":N(l.secondsPerPrimeSub);break;case"Tier 1":N(l.secondsPerTier1Sub);break;case"Tier 2":N(l.secondsPerTier2Sub);break;case"Tier 3":N(l.secondsPerTier3Sub)}if(h){var m=parseInt(h[1]);switch(E(m),h[2]){case"Twitch Prime":N(m*l.secondsPerPrimeSub);break;case"Tier 1":N(m*l.secondsPerTier1Sub);break;case"Tier 2":N(m*l.secondsPerTier2Sub);break;case"Tier 3":N(m*l.secondsPerTier3Sub)}}}}else t.includes("Welcome")||t.includes("JOIN")||t.includes("NAMES")?console.log("Received a known, ignored, message",t):console.error("Unhandled message",t)})}));var M=function(){return"justinfan"+(Math.floor(9e4*Math.random())+9999)};return Object(i.jsx)(i.Fragment,{children:Object(i.jsx)("div",{className:"App",children:o.length>0&&void 0!==l?Object(i.jsx)("span",{children:o}):Object(i.jsx)(s.a,{config:l,subsThisStream:O,subathonEndDate:P,timeLastAdded:I})})})}}).call(this,n(27).Buffer)},20:function(e,t,n){"use strict";var a=n(3),r=n(4),c=n(19),s=n(2),i=n(0),o=n(14),d=n.n(o),b=n(15),u=n(1);var l,j,h,f,O=function(e){var t=e.children,n=Object(i.useState)(!1),a=Object(s.a)(n,2),r=a[0],c=a[1],o=Object(i.useRef)(null);return Object(i.useEffect)((function(){var e=Object(b.a)(t,"normal 800 25px sans-serif");c(e>o.current.offsetWidth)}),[t]),Object(u.jsx)("div",{ref:o,children:r?Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)(d.a,{gradient:!1,speed:40,children:[t,"\xa0-\xa0"]})}):Object(u.jsx)(u.Fragment,{children:t})})};var m,p,v,w,g,x,S,P=function(e){var t=Math.abs(parseInt(e/60/60)).toString().padStart(2,"0"),n=Math.abs(parseInt(e/60%60)).toString().padStart(2,"0"),a=Math.abs(parseInt(e%60)).toString().padStart(2,"0");return"".concat(e<0?"-":"").concat(t,":").concat(n,":").concat(a)},T=r.a.span(l||(l=Object(a.a)(["\n  \n  animation: blinkRecentlyAdded step-end 0.3s infinite;\n\n  @keyframes blinkRecentlyAdded{\n    0% {\n      color: transparent;\n    }\n    50% {\n      color: var(--subathon-addedtime);\n    }\n    100% {\n      color: transparent;\n    }\n  }\n"]))),k=r.a.span(j||(j=Object(a.a)(["\n  color: var(--subathon-lowtime);\n"]))),D=r.a.span(h||(h=Object(a.a)(["\n  \n  animation: blinkCritical step-end 0.6s infinite;\n\n  @keyframes blinkCritical{\n    0% {\n      color: transparent;\n    }\n    30% {\n      color: var(--subathon-criticaltime);\n    }\n    70% {\n      color: var(--subathon-criticaltime);\n    }\n    100% {\n      color: transparent;\n    }\n  }\n"]))),I=r.a.span(f||(f=Object(a.a)(["\n"]))),y=function(e){var t=e.endDate,n=e.timeLastAdded,a=Object(i.useState)(!1),r=Object(s.a)(a,2),c=r[0],o=r[1],d=Object(i.useState)(""),b=Object(s.a)(d,2),l=b[0],j=b[1],h=Object(i.useState)(!1),f=Object(s.a)(h,2),O=f[0],m=f[1],p=Object(i.useState)(!1),v=Object(s.a)(p,2),w=v[0],g=v[1];return Object(i.useEffect)((function(){var e=setInterval((function(){o(new Date-n<=3e3),m(t-new Date<=36e5),g(t-new Date<=3e5),j(P(new Date(t-new Date)/1e3))}),200);return function(){return clearInterval(e)}}),[t,n]),c?Object(u.jsx)(T,{children:l}):w?Object(u.jsx)(D,{children:l}):O?Object(u.jsx)(k,{children:l}):Object(u.jsx)(I,{children:l})};var E=r.a.div(m||(m=Object(a.a)(["\n  font-weight: bold;\n  text-transform: uppercase;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  text-align: left;\n  width: 100%;\n"]))),N=r.a.div(p||(p=Object(a.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 65%;\n  align-items: flex-start;\n"]))),C=r.a.div(v||(v=Object(a.a)(["\n  font-size: 3rem;\n  width: 35%;\n"]))),M=r.a.div(w||(w=Object(a.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n"]))),A=r.a.div(g||(g=Object(a.a)(["\n  .progress-bar{\n    background-color: var(--subathon-progressbarcolor);\n  }\n"]))),F=r.a.div(x||(x=Object(a.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n"]))),R=r.a.div(S||(S=Object(a.a)(["\n  --subathon-criticaltime: #FF4136;\n  --subathon-lowtime: #FF4136;\n  --subathon-addedtime: #2ECC40;\n  --subathon-textcolor: white;\n  --subathon-progressbarcolor: #001f3f;\n  --subathon-background: linear-gradient(77deg, rgb(28,33,43) 0%, rgb(28,44,52) 50%, rgb(28,36,52) 100%);\n\n  text-align: center;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  padding: 0.5rem;\n  font-size: 1.5rem;\n  color: var(--subathon-textcolor);\n  background: var(--subathon-background);\n  width: 600px;\n  height: 150px;\n"])));t.a=function(e){var t=e.config,n=e.subsThisStream,a=e.subathonEndDate,r=e.timeLastAdded,s=function(){var e=Object.entries(t.goals).sort((function(e){return e[0]})).filter((function(e){return e[0]<=n}));return e.length>0?e[e.length-1]:[0,"No goal achieved"]},i=function(){var e=[1/0,"All goals achieved"],a=Object.entries(t.goals).sort((function(e){return e[0]})).filter((function(e){return e[0]>n}));return a.length>0?a[0]:e};return Object(u.jsxs)(R,{className:"SubathonContainer",children:[Object(u.jsxs)(M,{children:[Object(u.jsxs)(N,{children:[Object(u.jsxs)("span",{children:[i()[0]-n," subs needed for:"]}),Object(u.jsx)(E,{children:Object(u.jsx)(O,{children:i()[1]})})]}),Object(u.jsx)(C,{children:Object(u.jsx)(y,{endDate:a,timeLastAdded:r})})]}),Object(u.jsxs)(A,{children:[Object(u.jsx)(c.a,{animated:!0,now:n,min:s()[0],max:i()[0]}),Object(u.jsxs)(F,{children:[Object(u.jsx)("span",{children:s()[0]}),Object(u.jsx)("span",{children:n}),Object(u.jsx)("span",{children:i()[0]})]})]})]})}},21:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(12),s=n.n(c),i=(n(26),n(13)),o=n(1);s.a.render(Object(o.jsx)(r.a.StrictMode,{children:Object(o.jsx)(i.a,{})}),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.25970f49.chunk.js.map